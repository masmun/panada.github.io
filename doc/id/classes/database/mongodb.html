<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Panada PHP Framework 1.1.0 Documentation - MongoDB</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="../../../bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="../../../bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
<!--[if lt IE 9]>
  <script src="http://html5shim.googlepre.com/svn/trunk/html5.js"></script>
<![endif]-->
</head>
<body>
<div class="navbar navbar-static-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://panadaframework.com/" style="padding: 10px 20px 0px;"><img src="../../../images/logosimple.png"></a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="http://panadaframework.com/">Home</a></li>
	      <li><a href="https://github.com/panada/Panada">Source</a></li>
		<li class="active"><a href="http://panadaframework.com/documentation/id/">Doc</a></li>
		<li><a href="https://github.com/panada/Panada">Help and Report</a></li>
		<li><a href="http://panadaframework.com/blog/">Blog</a></li>
		<li><a href="http://twitter.com/panadaframework">Twitter</a></li>
            </ul>
            <form class="navbar-form pull-right" action="http://www.google.com/search" method="get">
                <input type="hidden" value="panadaframework.com/documentation/" id="as_sitesearch" name="as_sitesearch">
                <div class="input-append">
                    <input class="span2" id="appendedInputButton" type="text" name="q" placeholder="Search...">
                    <button class="btn" type="button"><i class="icon-search"></i></button>
                </div>
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
</div>
<div class="container-fluid">
    <div class="page-header">
        <h1>Panada Framework 1.1.0 Documentation</h1>
    </div>
    <div class="row-fluid">
        <div class="span3">
            <div class="sidebar-nav">
                <ul class="nav nav-list">
                    <li class="nav-header"><a href="../../index.html" class="muted">Umum</a></li>
                    <li><a href="../../index.html#about">Tentang Panada</a></li>
                    <li><a href="../../index.html#feature">Keunggulan (<em>Feature</em>)</a></li>
                    <li><a href="../../index.html#requirement">Requirement</a></li>
                    <li><a href="../../index.html#license">Lisensi</a></li>
                    <li class="divider"></li>
                    <li class="nav-header"><a href="../../config.html" class="muted">Konfigurasi</a></li>
                    <li><a href="../../config.html#general">Dasar</a></li>
                    <li><a href="../../config.html#additional_config">Tambahan</a></li>
                    <li><a href="../../config.html#webserver">Webserver</a></li>
                    <li class="divider"></li>
                    <li class="nav-header">Referensi</li>
                    <li><a href="../../references/controller.html">Controller</a></li>
                    <li><a href="../../references/model.html">Model</a></li>
                    <li><a href="../../references/view.html">View</a></li>
                    <li><a href="../../references/library.html">Library</a></li>
                    <li><a href="../../references/autoloader.html">Auto Loader</a></li>
                    <li><a href="../../references/global_method.html">Global Method dan Properties</a></li>
                    <li><a href="../../references/module.html">Module</a></li>
                    <li><a href="../../references/vendor.html">Vendor</a></li>
                    <li><a href="../../references/upgrade.html">Upgrade</a></li>
                    <li class="divider"></li>
                    <li class="nav-header"><a href="../../classes/index.html" class="muted">Resources</a></li>
                    <li class="active"><a href="index.html">Database</a></li>
		    <li>
			<ul>
			    <li><a href="query_builder.html">Query Builder</a></li>
			    <li><a href="activerecord.html">Active Record</a></li>
			    <li><a href="manual_query.html">Manual Query</a></li>
			    <li><a href="mongodb.html">Mongodb</a></li>
			</ul>
		    </li>
                    <li><a href="../../classes/cache/index.html">Cache</a></li>
                    <li><a href="../../classes/session.html">Session</a></li>
                    <li><a href="../../classes/pagination.html">Pagination</a></li>
                    <li><a href="../../classes/email.html">Email</a></li>
                    <li><a href="../../classes/encryption.html">Encryption</a></li>
                    <li><a href="../../classes/upload.html">Upload</a></li>
                    <li><a href="../../classes/image.html">Image</a></li>
                    <li><a href="../../classes/request.html">Request</a></li>
                    <li><a href="../../classes/rest.html">RESTfull</a></li>
                    <li><a href="../../classes/tools.html">Tools</a></li>
                    <li><a href="../../classes/validation.html">Form Validation</a></li>
                    <li class="divider"></li>
                    <li><a href="../../contribution.html">Kontribusi</a></li>
                    <li><a href="../../credit.html">Credit</a></li>
                </ul>
            </div>
        </div>
      <div class="span9">
        <div class="row-fluid">
	    <div class="page-header">
                <h2>MongoDB</h2>
	    </div>
            <p>MongoDB adalah scalable, high-performance, open source database NoSQL yang berorientasikan dokumen. Dengan MongoDB memungkinkan penyimpanan data dilakukan tanpa perlu diawali dengan pembuatan skema database. Setiap data disimpan berformat herarki, di mana setiap record bisa memiliki herarki yang berbeda dengan record lainnya dalam satu collection/tabel yang sama.</p>
	    <p>Lebih lanjut mengenai MongoDB bisa dilihat di <a href="http://www.mongodb.org" target="_blank">http://www.mongodb.org</a>.</p>
	    <p><strong>Untuk menggunakan Driver ini, pastikan PHP Anda telah terinstall ekstensi Mongo</strong>.</p>
	    <p>Driver MongoDB Panada merupakan inheritance dari class Mongo yang telah tersedia secara natif oleh ekstensi Mongo. Hal ini berarti, semua resources yang ada pada class Mongo, bisa juga langsung digunakan pada Driver MongoDB.</p>
	    <p>Di bawah adalah beberapa contoh dari method-method yang paling sering digunakan.</p>
	    <p>Informasi lebih lanjut mengenai MongoDB API's silahkan lihat <a target="_blank" href="http://www.mongodb.org/display/DOCS/Tutorial">http://www.mongodb.org/display/DOCS/Tutorial</a></p>
	</div>
            <div class="row-fluid">
                <div class="page-header"><h2>Konfigurasi</h2></div>
		
                <p>Konfigurasi dilakukan di file <strong>app/config/database.php</strong></p>
                <p>Berikut adalah contohnya:</p>
<pre rows="12" cols="50" class="pre">
'default' => array(
    'driver' => 'mongodb',
    'host' => 'localhost',
    'user' => '',
    'password' => '',
    'database' => 'my_database',
    'charset' => '',
    'collate' => '',
    'persistent' => false,
    'options' => array(),
)
</pre>
                <p>Jika ingin menambahkan opsi tambahan pada connection option, bisa dilakukan pada bagian <b>options</b></p>
                <p>Lebih lanjut mengenai connection option, silahkan lihat di <a href="http://www.php.net/manual/en/mongo.construct.php" target="_blank">http://www.php.net/manual/en/mongo.construct.php</a></p>
                <p>Berikut adalah contoh connection option replica set dengan setting auto-connect false:</p>
                <pre>'options' => array('replicaSet' => true, 'connect' => false),</pre>
		<p>Jika koneksi ke server MongoDB lebih dari satu (misalnya pada penggunaan <strong>Replica Set</strong>), berikut adalah contohnya:</p>
		<pre>'host' => 'localhost, 192.168.10.20, 192.168.10.21',</pre>
            </div>
            
            <div class="row-fluid">
                <div class="page-header"><h2 id="init">Inisialisasi</h2></div>
                <p>Jika MongoDB digunakan sebagai database default, inisialisasinya sama seperti database yang lainnya.</p>
                <pre>$this->db = new Resources\Database;</pre>
		<p>Atau jika MongoDB terletak pada <a href="index.html#config">setting koneksi</a> dengan nama koneksi <strong>mongodb</strong>, maka contoh inisalisasinya:</p>
		<pre>$this->mongodb = new Resources\Database('mongodb');</pre>
            </div>
            
            <div class="row-fluid">
                <div class="page-header"><h2 id="connect">Connect</h2></div>
                <p>Secara default, ketika Library MongoDB maka koneksi ke Mongo server akan dibuat. Namun feature ini bisa dinonaktifkan dengan menambahkan parameter <b>array('connect' => false); </b> seperti contoh di atas.</p>
                <p>Jika setting ini dilakukan, maka setiap akan melakukan request data perlu diinisialisasi konkeksi baru, dengan method:</p>
                <pre>$this->mongodb-><b>connect</b>();</pre>
            </div>
            
            <div class="row-fluid">
                <div class="page-header"><h2 id="collection">Collection</h2></div>
                <p>Untuk menentukan collection yang akan dipilih, gunakan method:</p>
                <pre>$this->mongodb-><b>collection</b>(string $collection);</pre>
                <p>Sebagai contoh, untuk mendapatkan collection <b>users</b>, penggunaannya:</p>
                <pre>$this->mongodb->collection('users');</pre>
            </div>
	    
	    <div class="row-fluid">
                <div class="page-header"><h2 id="insert">Insert</h2></div>
                <p>Untuk menambahkan data baru, gunakan method:</p>
                <pre>$this->mongodb->collection('collection_name')-><b>insert</b>( array | object $data );</pre>
                <p><b>$data</b> bisa berupa array atau object.</p>
                <p>Lebih lanjut mengenai insert di MongoDB, lihat di <a target="_blank" href="http://www.php.net/manual/en/mongo.writes.php">http://www.php.net/manual/en/mongo.writes.php</a> dan <a target="_blank" href="http://www.mongodb.org/display/DOCS/Inserting">http://www.mongodb.org/display/DOCS/Inserting</a></p>
            </div>
            
            <div class="row-fluid">
                <div class="page-header"><h2 id="find">Find</h2></div>
                <p>Untuk mendapatkan data dengan jumlah lebih dari satu, gunakan method:</p>
                <pre>$this->mongodb->collection('collection_name')-><b>find</b>( array $criteria = array() );</pre>
                
                <p><b>$criteria</b> adalah item array untuk melakukan filter terhadap data yang ingin didapatkan.</p>
		<p>Contoh penggunaan untuk "dapatkan user dengan id kurang dari atau sama dengan 20 dari collection/tabel users":</p>
<pre>
$criteria = array('id' => array('$lte' => 20) );<br />
$cursor = $this->mongodb->collection('users')->find($criteria);
</pre>
                <p>Lebih lanjut mengenai query dan kriteria di MongoDB, lihat di <a target="_blank" href="http://www.mongodb.org/display/DOCS/Querying">http://www.mongodb.org/display/DOCS/Querying</a>
            </div>
	    
	    <div class="row-fluid">
                <div class="page-header"><h2 id="cursor_results">CursorResults</h2></div>
                <p>Secara default, output data yang diberikan oleh Mongo berformat array. Untuk menampilkan data yang diambil dari method <b>find</b> dengan format object, Panada menyediakan method <b>cursorResults</b>:</p>
<pre>
$cursor = $this->mongodb->collection('users')->find()->limit(3);<br />
$data = $this->mongodb-><b>cursorResults</b>($cursor);
</pre>
                
            </div>
	    
	    <div class="row-fluid">
                <div class="page-header"><h2 id="findone">FindOne</h2></div>
                <p>Sedangkan untuk mendapatkan data dengan jumlah satu, gunakan method:</p>
                <pre>$this->mongodb->collection('collection_name')-><b>findOne</b>( array $criteria = array() );</pre>
                
                <p>Contoh penggunaan untuk "dapatkan user dengan id 20 dari collection/tabel users":</p>
<pre>
$criteria = array('id' => (int) 20 );<br />
$value = $this->mongodb->collection('users')->findOne($criteria);
</pre>
                
            </div>
            
            <div class="row-fluid">
                <div class="page-header"><h2 id="update">Update</h2></div>
                <p>Untuk memperbaharui data gunakan method:</p>
                <pre>$this->mongodb->collection('collection_name')-><b>update</b>( array $criteria = array(), array('$set' => $data) );</pre>
                <p>Informasi mengenai API update, silahkan lihat <a target="_blank" href="http://www.mongodb.org/display/DOCS/Updating">http://www.mongodb.org/display/DOCS/Updating</a></p>
            </div>
            
            <div class="row-fluid">
                <div class="page-header"><h2 id="remove">Remove</h2></div>
                <p>Untuk penghapusan data, gunakan method:</p>
                <pre>$this->mongodb->collection('collection_name')-><b>remove</b>( array $criteria = array() );</pre>
                <p>Informasi mengenai API remove, silahkan lihat <a target="_blank" href="http://www.mongodb.org/display/DOCS/Removing">http://www.mongodb.org/display/DOCS/Removing</a></p>
            </div>
	    
	    <div class="row-fluid">
		<div class="page-header"><h2 id="contoh">Contoh</h2></div>
<pre rows="121" cols="50" class="pre">
&lt;?php
namespace Models;
use Resources;

class Model
{    
    public function __construct()
    {
        parent::__construct();
        $this->mongodb = new Resources\Database('mongodb');
    }
    
    public function insertUser()
    {	
	// Insert new 4 records
	$my_data = array(
	    array(
		'email' => 'jhon@domain.co.id',
		'name' => 'Jhon Smith',
		'city' => 'New York'
	    ),
	    array(
		'email' => 'mark@foo.com',
		'name' => 'Mark W',
		'city' => ''
	    ),
	    array(
		'email' => 'rossi@rossi.com',
		'name' => 'V Rossi',
		'country' => 'Italy'
	    ),
	    array(
		'email' => 'simon@googlegmail.com',
		'name' => 'Simon C',
		'country' => 'Italy'
	    )
	);
	
	$collection = $this->mongodb->collection('users');
	foreach($myData as $data){
	    $collection->insert($data);
	}
    }
    
    public function getUsers()
    {	
	$cursor = $this->mongodb->collection('users')->find()->limit(3);
        
	foreach ($cursor as $value){
	    
            print_r($value);
	}
	
	/*
	Output:
	Array ( [_id] => MongoId Object ( ) [email] => jhon@domain.co.id [name] => Jhon Smith [city] => New York ) Array ( [_id] => MongoId Object ( ) [email] => mark@foo.com [name] => Mark W [city] => ) Array ( [_id] => MongoId Object ( ) [email] => rossi@rossi.com [name] => V Rossi [country] => Italy )
	*/
	
	// Wrap results from mongo output into object
	$obj_data = $this->mongodb->cursor_results($cursor);
	
	print_r($obj_data);
	
	/*
	Output:
	Array ( [0] => stdClass Object ( [_id] => MongoId Object ( ) [email] => jhon@domain.co.id [name] => Jhon Smith [city] => New York ) [1] => stdClass Object ( [_id] => MongoId Object ( ) [email] => mark@foo.com [name] => Mark W [city] => ) [2] => stdClass Object ( [_id] => MongoId Object ( ) [email] => rossi@rossi.com [name] => V Rossi [country] => Italy ) ) 
	*/
    }
    
    public function getUser()
    {	
	$criteria = array('email' => 'rossi@rossi.com');
	
	$user = $this->mongodb->collection('users')->findOne($criteria);
	print_r($user);
	
	/*
	Output:
	Array ( [_id] => MongoId Object ( ) [email] => rossi@rossi.com [name] => V Rossi [country] => Italy )
	*/
    }
    
    public function updateUser()
    {	
	$criteria = array('email' => 'jhon@domain.co.id');
	$data = array('name' => 'Jhon Doo');
	
	$collection = $this->mongodb->collection('users');
	
	$collection->update($criteria, array('$set' => $data) );
	
	$user = $collection->findOne($criteria);
	print_r($user);
	
	/*
	Output:
	Array ( [_id] => MongoId Object ( ) [city] => New York [email] => jhon@domain.co.id [name] => Jhon Doo ) 
	*/
    }
    
    public function removeUser()
    {	
	$criteria = array('email' => 'mark@foo.com');
	
	$collection = $this->mongodb->collection('users');
	
	$collection->remove( $criteria );
	
	$user = $collection->findOne($criteria);
	var_dump($user);
	
	/*
	Output:
	NULL
	*/
    }

}
</pre>
	    </div>
	    
        
	<div class="row-fluid">
            <div class="page-header" id="discussion">
                <h2>Diskusi</h2>
            </div>
	    <div id="disqus_thread"></div>
	</div>
      </div>
    </div>
    <hr>
    <footer>
	<p>Menemukan typo? atau ingin menambahkan informasi di halaman ini? silahkan <a href="https://github.com/panada/documentation/blob/master/classes/database/mongodb.html">fork dan edit</a>.</p>
    </footer>
</div>
<script>
var disqus_url = 'classes/database/mongodb.html';
</script>
<script src="../../../jquery.js"></script>
<script src="../../../bootstrap/js/bootstrap.min.js"></script>
<script src="../../../panada.js"></script>
</body>
</html>